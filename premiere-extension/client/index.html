<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Clean Cut - Premiere Extension</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="header">
      <h1 class="title">Clean-Cut</h1>
      <p class="subtitle">Debug Panel - Premiere Pro</p>
    </div>

    <div class="info-section">
      <div class="info-box">
        <div class="info-title">How it works:</div>
        <div class="info-text">
          This extension connects to your Clean-Cut desktop app. It is designed to have all the
          testing functionality to support the Clean-Cut app. It is not designed to be used as a
          standalone tool, and can be hidden by default. You can edit the 'AutoVisible' tag in the
          manifest.xml file to 'false' to hide it by default.
        </div>
      </div>
    </div>

    <div class="status-section">
      <label class="status-label">Connection Status</label>
      <div class="status-container">
        <div class="status-header">
          <span class="status-content">
            <div id="status-indicator" class="status-indicator disconnected"></div>
            <span id="status-text" class="status-text">Connected to Clean-Cut app</span>
          </span>
          <button id="reconnect-button" class="refresh-button" onclick="reconnectToApp()">
            Disconnect
          </button>
        </div>
        <div id="status-details" class="status-details">Port: ---</div>
      </div>
    </div>

    <div class="sequence-section">
      <label class="status-label">Active Sequence</label>
      <div class="sequence-container">
        <div class="sequence-header">
          <span id="sequence-name" class="sequence-name">No active sequence</span>
          <button class="refresh-button" onclick="refreshSequenceInfo()">Refresh</button>
        </div>
        <div id="sequence-details" class="sequence-details">No sequence data</div>
      </div>
    </div>

    <div class="sequence-details-section">
      <label class="status-label">Sequence Details</label>
      <div id="sequence-details-container" class="details-container">
        <p><strong>Frame Rate:</strong> <span id="detail-frame-rate">N/A</span></p>
        <p><strong>Duration:</strong> <span id="detail-end-time">N/A</span></p>
        <p><strong>In Point:</strong> <span id="detail-in-point">N/A</span></p>
        <p><strong>Out Point:</strong> <span id="detail-out-point">N/A</span></p>
        <p>
          <strong>Audio Tracks (<span id="detail-audio-track-count">0</span>):</strong>
        </p>
        <div id="detail-audio-tracks" class="details-list">None</div>
        <p><strong>Selection:</strong></p>
        <div id="detail-selection" class="details-list">None</div>
      </div>
    </div>

    <div class="export-media-section">
      <label class="status-label">Export Media Test</label>
      <div class="details-container">
        <div class="track-selection-section">
          <p><strong>1 - Select Audio Tracks to Export:</strong></p>
          <div id="audio-track-checkboxes" class="track-checkboxes">
            <div class="no-tracks-message">
              No audio tracks detected. Please refresh sequence info.
            </div>
          </div>
          <div class="track-controls">
            <button type="button" onclick="selectAllTracks()" class="track-control-button">
              Select All
            </button>
            <button type="button" onclick="deselectAllTracks()" class="track-control-button">
              Deselect All
            </button>
          </div>
        </div>

        <div class="separator"></div>

        <div class="range-selection-section">
          <p><strong>2 - Select Range:</strong></p>
          <div class="range-buttons">
            <button
              type="button"
              id="range-entire"
              class="range-button active"
              onclick="selectRange('entire')"
            >
              Entire Timeline
            </button>
            <button
              type="button"
              id="range-inout"
              class="range-button"
              onclick="selectRange('inout')"
            >
              In/Out Points
            </button>
            <button
              type="button"
              id="range-selected"
              class="range-button"
              onclick="selectRange('selected')"
            >
              Selected Clips
            </button>
          </div>
        </div>

        <div class="separator"></div>

        <p><strong>3 - Output Folder:</strong></p>
        <div class="form-row">
          <input
            type="text"
            id="export-folder-input"
            placeholder="/path/to/export/folder"
            class="form-input"
          />
          <button id="export-button" onclick="performAudioExport()" class="form-button export">
            Export Audio
          </button>
        </div>
        <p class="form-help-text">
          Exports audio as 48kHz 16-bit WAV file for analysis. Leave empty to use system temp
          folder.
        </p>
      </div>
    </div>

    <div class="cut-tracks-section">
      <label class="status-label">Cut All Tracks Test</label>
      <div class="details-container">
        <p><strong>Cut Time:</strong></p>
        <div class="form-row">
          <input
            type="text"
            id="cut-time-input"
            placeholder="00:00:00:00"
            class="form-input"
            maxlength="11"
          />
          <button id="cut-button" onclick="performCutAtTime()" class="form-button cut">Cut</button>
        </div>
        <p class="form-help-text">Enter time in HH:MM:SS:FF format (e.g., 00:01:30:15)</p>
      </div>
    </div>

    <div class="silence-management-section">
      <label class="status-label">Silence Management Test</label>
      <div class="details-container">
        <p><strong>Action for Selected Clip:</strong></p>
        <div class="form-row">
          <select id="silence-action-select" class="form-select">
            <option value="remove-keep-gap">Remove (Keep Gap)</option>
            <option value="remove-ripple">Remove (Ripple Delete)</option>
            <option value="mute">Mute Clip</option>
          </select>
          <button
            id="silence-process-button"
            onclick="performSilenceManagement()"
            class="form-button process"
          >
            Process
          </button>
        </div>
        <p class="form-help-text">Select a clip first, then choose an action to apply</p>
      </div>
    </div>

    <div class="logs-section">
      <label class="status-label">Debug Log</label>
      <div id="logs-container" class="logs-container">
        <div class="log-entry">
          <span class="log-timestamp">[00:00:00]</span>
          <span class="log-info">Extension loaded</span>
        </div>
      </div>
    </div>

    <div class="version-info">Clean-Cut Extension v1.0.0</div>

    <script type="text/javascript" src="./CSInterface.js"></script>
    <script src="main.js"></script>
  </body>
</html>
