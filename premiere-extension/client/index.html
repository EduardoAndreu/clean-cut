<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Clean Cut - Premiere Extension</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="header">
      <h1 class="title">Clean-Cut</h1>
      <p class="subtitle">Premiere Pro Extension</p>
    </div>

    <div class="status-section">
      <label class="status-label">Connection Status</label>
      <div class="status-container">
        <div class="status-header">
          <div id="status-indicator" class="status-indicator disconnected"></div>
          <span id="status-text" class="status-text">Disconnected from Clean-Cut app</span>
        </div>
        <div id="status-details" class="status-details">Port: ---</div>
      </div>
    </div>

    <div class="sequence-section">
      <label class="status-label">Active Sequence</label>
      <div class="sequence-container">
        <div class="sequence-header">
          <span id="sequence-name" class="sequence-name">No active sequence</span>
          <button class="refresh-button" onclick="refreshSequenceInfo()">Refresh</button>
        </div>
        <div id="sequence-details" class="sequence-details">No sequence data</div>
      </div>
    </div>

    <div class="sequence-details-section">
      <label class="status-label">Sequence Details</label>
      <div id="sequence-details-container" class="details-container">
        <p><strong>Frame Rate:</strong> <span id="detail-frame-rate">N/A</span></p>
        <p><strong>Duration:</strong> <span id="detail-end-time">N/A</span></p>
        <p><strong>In Point:</strong> <span id="detail-in-point">N/A</span></p>
        <p><strong>Out Point:</strong> <span id="detail-out-point">N/A</span></p>
        <p>
          <strong>Audio Tracks (<span id="detail-audio-track-count">0</span>):</strong>
        </p>
        <div id="detail-audio-tracks" class="details-list">None</div>
        <p><strong>Selection:</strong></p>
        <div id="detail-selection" class="details-list">None</div>
      </div>
    </div>

    <div class="export-media-section">
      <label class="status-label">Export Media Test</label>
      <div class="details-container">
        <p><strong>Output Folder:</strong></p>
        <div class="form-row">
          <input
            type="text"
            id="export-folder-input"
            placeholder="/path/to/export/folder"
            class="form-input"
          />
          <button id="export-button" onclick="performAudioExport()" class="form-button export">
            Export Audio
          </button>
        </div>
        <p class="form-help-text">
          Exports audio as 48kHz 16-bit WAV file for analysis. Leave empty to use system temp
          folder.
        </p>

        <div class="track-selection-section">
          <p><strong>Select Audio Tracks to Export:</strong></p>
          <div id="audio-track-checkboxes" class="track-checkboxes">
            <div class="no-tracks-message">
              No audio tracks detected. Please refresh sequence info.
            </div>
          </div>
          <div class="track-controls">
            <button type="button" onclick="selectAllTracks()" class="track-control-button">
              Select All
            </button>
            <button type="button" onclick="deselectAllTracks()" class="track-control-button">
              Deselect All
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="cut-tracks-section">
      <label class="status-label">Cut All Tracks</label>
      <div class="details-container">
        <p><strong>Cut Time:</strong></p>
        <div class="form-row">
          <input
            type="text"
            id="cut-time-input"
            placeholder="00:00:00:00"
            class="form-input"
            maxlength="11"
          />
          <button id="cut-button" onclick="performCutAtTime()" class="form-button cut">Cut</button>
        </div>
        <p class="form-help-text">Enter time in HH:MM:SS:FF format (e.g., 00:01:30:15)</p>
      </div>
    </div>

    <div class="info-section">
      <div class="info-box">
        <div class="info-title">How it works:</div>
        <div class="info-text">
          This extension connects to your Clean-Cut desktop app. When you process audio in the main
          app using "Process from Premiere Pro" mode, this extension will automatically export your
          active sequence audio and perform cuts based on detected silence.
        </div>
      </div>
    </div>

    <div class="action-section">
      <button id="reconnect-button" class="action-button" onclick="reconnectToApp()">
        Reconnect to Clean-Cut App
      </button>
    </div>

    <div class="logs-section">
      <label class="status-label">Activity Log</label>
      <div id="logs-container" class="logs-container">
        <div class="log-entry">
          <span class="log-timestamp">[00:00:00]</span>
          <span class="log-info">Extension loaded</span>
        </div>
      </div>
    </div>

    <div class="version-info">Clean-Cut Extension v1.0.0</div>

    <script type="text/javascript" src="./CSInterface.js"></script>
    <script src="main.js"></script>
  </body>
</html>
